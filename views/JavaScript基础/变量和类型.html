<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>变量和类型 | Q_ZHANG | 博客</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/zhangqcoder.github.io/favicon.ico">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/zhangqcoder.github.io/assets/css/0.styles.6ba5cf30.css" as="style"><link rel="preload" href="/zhangqcoder.github.io/assets/js/app.2fbe9a60.js" as="script"><link rel="preload" href="/zhangqcoder.github.io/assets/js/3.9b3e945d.js" as="script"><link rel="preload" href="/zhangqcoder.github.io/assets/js/1.536d7332.js" as="script"><link rel="preload" href="/zhangqcoder.github.io/assets/js/14.03153890.js" as="script"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/10.0499ae18.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/11.dc3e6a33.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/12.def533aa.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/13.cecf10a4.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/15.f3e86cdb.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/16.15e22119.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/17.5200b1dc.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/18.30dde99e.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/19.c3c5c054.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/20.7b0370a6.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/21.14638639.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/22.367643f5.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/4.33838abe.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/5.902dfa89.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/6.c9f1f877.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/7.d468299f.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/8.8ed7383a.js"><link rel="prefetch" href="/zhangqcoder.github.io/assets/js/9.fe60f684.js">
    <link rel="stylesheet" href="/zhangqcoder.github.io/assets/css/0.styles.6ba5cf30.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-945f89ac><div data-v-945f89ac><div id="loader-wrapper" class="loading-wrapper" data-v-71fac282 data-v-945f89ac data-v-945f89ac><div class="loader-main" data-v-71fac282><div data-v-71fac282></div><div data-v-71fac282></div><div data-v-71fac282></div><div data-v-71fac282></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-3dc17307 data-v-945f89ac data-v-945f89ac><h3 class="title" style="display:none;" data-v-3dc17307 data-v-3dc17307>Q_ZHANG | 博客</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-3dc17307 data-v-3dc17307><input type="password" value="" data-v-3dc17307> <span data-v-3dc17307>Konck! Knock!</span> <button data-v-3dc17307>OK</button></label> <div class="footer" style="display:none;" data-v-3dc17307 data-v-3dc17307><span data-v-3dc17307><i class="iconfont reco-theme" data-v-3dc17307></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-3dc17307>vuePress-theme-reco</a></span> <span data-v-3dc17307><i class="iconfont reco-copyright" data-v-3dc17307></i> <a data-v-3dc17307><span data-v-3dc17307>Q_ZHANG</span>
            
          <span data-v-3dc17307>2017 - </span>
          2020
        </a></span></div></div> <div class="hide" data-v-945f89ac><header class="navbar" data-v-945f89ac><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zhangqcoder.github.io/" class="home-link router-link-active"><img src="/zhangqcoder.github.io/avatar.png" alt="Q_ZHANG | 博客" class="logo"> <span class="site-name">Q_ZHANG | 博客</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zhangqcoder.github.io/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/数据结构和算法/" class="nav-link"><i class="iconfont undefined"></i>
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/Vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/Canvas/" class="nav-link"><i class="iconfont undefined"></i>
  Canvas
</a></li><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/JavaScript基础/" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript基础
</a></li></ul></div></div><div class="nav-item"><a href="/zhangqcoder.github.io/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zhangqcoder" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-945f89ac></div> <aside class="sidebar" data-v-945f89ac><div class="personal-info-wrapper" data-v-661bee24><img src="/zhangqcoder.github.io/avatar.png" alt="author-avatar" class="personal-img" data-v-661bee24> <h3 class="name" data-v-661bee24>
    Q_ZHANG
  </h3> <div class="num" data-v-661bee24><div data-v-661bee24><h3 data-v-661bee24>11</h3> <h6 data-v-661bee24>Article</h6></div> <div data-v-661bee24><h3 data-v-661bee24>3</h3> <h6 data-v-661bee24>Tag</h6></div></div> <hr data-v-661bee24></div> <nav class="nav-links"><div class="nav-item"><a href="/zhangqcoder.github.io/" class="nav-link"><i class="iconfont reco-home"></i>
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      分类
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/数据结构和算法/" class="nav-link"><i class="iconfont undefined"></i>
  数据结构和算法
</a></li><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/Vue/" class="nav-link"><i class="iconfont undefined"></i>
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/Canvas/" class="nav-link"><i class="iconfont undefined"></i>
  Canvas
</a></li><li class="dropdown-item"><!----> <a href="/zhangqcoder.github.io/categories/JavaScript基础/" class="nav-link"><i class="iconfont undefined"></i>
  JavaScript基础
</a></li></ul></div></div><div class="nav-item"><a href="/zhangqcoder.github.io/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  标签
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      联系
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/zhangqcoder" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>变量和类型</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#一、javascript-规定了几种语言类型" class="sidebar-link">一、JavaScript 规定了几种语言类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#二、javascript-对象的底层数据结构是什么" class="sidebar-link">二、JavaScript 对象的底层数据结构是什么</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#三、symbol-类型在实际开发中的应用、可手动实现一个简单的-symbol" class="sidebar-link">三、Symbol 类型在实际开发中的应用、可手动实现一个简单的 Symbol</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#四、javascript-中的变量在内存中的具体存储形式" class="sidebar-link">四、JavaScript 中的变量在内存中的具体存储形式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#五、基本类型对应的内置对象，以及他们之间的装箱拆箱操作" class="sidebar-link">五、基本类型对应的内置对象，以及他们之间的装箱拆箱操作</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#六、理解值类型和引用类型" class="sidebar-link">六、理解值类型和引用类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#七、null-和-undefined-的区别" class="sidebar-link">七、null 和 undefined 的区别</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#八、至少可以说出三种判断-javascript-数据类型的方式，以及他们的优缺点，如何准确的判断数组类型" class="sidebar-link">八、至少可以说出三种判断 JavaScript 数据类型的方式，以及他们的优缺点，如何准确的判断数组类型</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#九、可能发生隐式类型转换的场景以及转换原则，应如何避免或巧妙应用" class="sidebar-link">九、可能发生隐式类型转换的场景以及转换原则，应如何避免或巧妙应用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html#十、出现小数精度丢失的原因，javascript-可以存储的最大数字、最大安全数字，javascript-处理大数字的方法、避免精度丢失的方法" class="sidebar-link">十、出现小数精度丢失的原因，JavaScript 可以存储的最大数字、最大安全数字，JavaScript 处理大数字的方法、避免精度丢失的方法</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-3dc17307 data-v-945f89ac><h3 class="title" style="display:none;" data-v-3dc17307 data-v-3dc17307>变量和类型</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-3dc17307 data-v-3dc17307><input type="password" value="" data-v-3dc17307> <span data-v-3dc17307>Konck! Knock!</span> <button data-v-3dc17307>OK</button></label> <div class="footer" style="display:none;" data-v-3dc17307 data-v-3dc17307><span data-v-3dc17307><i class="iconfont reco-theme" data-v-3dc17307></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-3dc17307>vuePress-theme-reco</a></span> <span data-v-3dc17307><i class="iconfont reco-copyright" data-v-3dc17307></i> <a data-v-3dc17307><span data-v-3dc17307>Q_ZHANG</span>
            
          <span data-v-3dc17307>2017 - </span>
          2020
        </a></span></div></div> <div data-v-945f89ac><main class="page"><div class="page-title" style="display:none;"><h1>变量和类型</h1> <hr> <div data-v-32e7eb69><i class="iconfont reco-account" data-v-32e7eb69><span data-v-32e7eb69>Q_ZHANG</span></i> <i class="iconfont reco-date" data-v-32e7eb69><span data-v-32e7eb69>2019-09-14 16:47:00</span></i> <i class="iconfont reco-eye" data-v-32e7eb69><span id="/zhangqcoder.github.io/views/JavaScript%E5%9F%BA%E7%A1%80/%E5%8F%98%E9%87%8F%E5%92%8C%E7%B1%BB%E5%9E%8B.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-32e7eb69><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-32e7eb69><span class="tag-item" data-v-32e7eb69>JavaScript</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><blockquote><p>前端工程师吃饭的家伙，深度、广度一样都不能差。</p></blockquote> <h2 id="一、javascript-规定了几种语言类型"><a href="#一、javascript-规定了几种语言类型" class="header-anchor">#</a> 一、JavaScript 规定了几种语言类型</h2> <p>7 种基本数据类型：<code>BigInt、Symbol、Undefined、Null、Boolean、Number和String</code></p> <p>1 种复杂数据类型：<code>Object</code></p> <h2 id="二、javascript-对象的底层数据结构是什么"><a href="#二、javascript-对象的底层数据结构是什么" class="header-anchor">#</a> 二、JavaScript 对象的底层数据结构是什么</h2> <p>通过 V8 的源码尝试分析 Object 的实现：V8 里面所有的数据类型的根父类都是 Object，Object 派生 HeapObject，提供存储基本功能，往下的 JSReceiver 用于原型查找，再往下的 JSObject 就是 JS 里面的 Object，Array/Function/Date 等继承于 JSObject。左边的 FixedArray 是实际存储数据的地方。
<img src="https://upload-images.jianshu.io/upload_images/12812588-840fa96a778d3be2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="">
在创建一个 JSObject 之前，会先把读到的 Object 的文本属性序列化成 constant_properties，如下的 data：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'yin'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  <span class="token string">'-school-'</span><span class="token operator">:</span> <span class="token string">'high school'</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>会被序列成：</p> <p>../../v8/src/runtime/runtime-literals.cc 72 constant_properties:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">0xdf9ed2aed19</span><span class="token operator">:</span> <span class="token punctuation">[</span>FixedArray<span class="token punctuation">]</span>

– length<span class="token operator">:</span> <span class="token number">6</span>

  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0x1b5ec69833d1</span> <span class="token operator">&lt;</span>String<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">:</span> name<span class="token operator">&gt;</span>

  <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0xdf9ed2aec51</span> <span class="token operator">&lt;</span>String<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">:</span> yin<span class="token operator">&gt;</span>

  <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0xdf9ed2aec71</span> <span class="token operator">&lt;</span>String<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">:</span> age<span class="token operator">&gt;</span>

  <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">18</span>

  <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0xdf9ed2aec91</span> <span class="token operator">&lt;</span>String<span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token operator">-</span>school<span class="token operator">-</span><span class="token operator">&gt;</span>

  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token number">0xdf9ed2aecb1</span> <span class="token operator">&lt;</span>String<span class="token punctuation">[</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token operator">:</span> high school<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>它是一个 FixedArray，一共有 6 个元素，由于 data 总共是有 3 个属性，每个属性有一个 key 和一个 value，所以 Array 就有 6 个。第一个元素是第一个 key，第二个元素是第一个 value，第三个元素是第二个 key，第四个元素是第二个 key，依次类推。</p> <p>Object 提供了一个 Print()的函数，把它用来打印对象的信息非常有帮助。上面的输出有两种类型的数据，一种是 String 类型，第二种是整型类型的。
FixedArray 是 V8 实现的一个类似于数组的类，它表示一段连续的内存。</p> <p>参考自：<a href="https://www.rrfed.com/2017/04/04/chrome-object/" target="_blank" rel="noopener noreferrer">https://www.rrfed.com/2017/04/04/chrome-object/<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="三、symbol-类型在实际开发中的应用、可手动实现一个简单的-symbol"><a href="#三、symbol-类型在实际开发中的应用、可手动实现一个简单的-symbol" class="header-anchor">#</a> 三、Symbol 类型在实际开发中的应用、可手动实现一个简单的 Symbol</h2> <p><strong>应用场景 1：使用 Symbol 来作为对象属性名(key)</strong></p> <p>在这之前，我们通常定义或访问对象的属性时都是使用字符串，比如下面的代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  abc<span class="token operator">:</span> <span class="token number">123</span><span class="token punctuation">,</span>
  hello<span class="token operator">:</span> <span class="token string">'world'</span>
<span class="token punctuation">}</span>

obj<span class="token punctuation">[</span><span class="token string">'abc'</span><span class="token punctuation">]</span> <span class="token comment">// 123</span>
obj<span class="token punctuation">[</span><span class="token string">'hello'</span><span class="token punctuation">]</span> <span class="token comment">// 'world'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>而现在，Symbol 可同样用于对象属性的定义和访问：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PROP_NAME</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">PROP_AGE</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">PROP_NAME</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'一斤代码'</span>
<span class="token punctuation">}</span>
obj<span class="token punctuation">[</span><span class="token constant">PROP_AGE</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">18</span>

obj<span class="token punctuation">[</span><span class="token constant">PROP_NAME</span><span class="token punctuation">]</span> <span class="token comment">// '一斤代码'</span>
obj<span class="token punctuation">[</span><span class="token constant">PROP_AGE</span><span class="token punctuation">]</span> <span class="token comment">// 18</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>随之而来的是另一个非常值得注意的问题：就是当使用了 Symbol 作为对象的属性 key 后，在对该对象进行 key 的枚举时，会有什么不同？在实际应用中，我们经常会需要使用 Object.keys()或者 for...in 来枚举对象的属性名，那在这方面，Symbol 类型的 key 表现的会有什么不同之处呢？来看以下示例代码：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'一斤代码'</span><span class="token punctuation">,</span>
  age<span class="token operator">:</span> <span class="token number">18</span><span class="token punctuation">,</span>
  title<span class="token operator">:</span> <span class="token string">'Engineer'</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// ['age', 'title']</span>

<span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> p <span class="token keyword">in</span> obj<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span> <span class="token comment">// 分别会输出：'age' 和 'title'</span>
<span class="token punctuation">}</span>

Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// ['age', 'title']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>由上代码可知，Symbol 类型的 key 是不能通过 Object.keys()或者 for...in 来枚举的，它未被包含在对象自身的属性名集合(property names)之中。所以，利用该特性，我们可以把一些不需要对外操作和访问的属性使用 Symbol 来定义。</p> <p>也正因为这样一个特性，当使用 JSON.stringify()将对象转换成 JSON 字符串的时候，Symbol 属性也会被排除在输出内容之外：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// {&quot;age&quot;:18,&quot;title&quot;:&quot;Engineer&quot;}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>我们可以利用这一特点来更好的设计我们的数据对象，让“对内操作”和“对外选择性输出”变得更加优雅。</p> <p>然而，这样的话，我们就没办法获取以 Symbol 方式定义的对象属性了么？非也。还是会有一些专门针对 Symbol 的 API，比如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 使用Object的API</span>
Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// [Symbol(name)]</span>

<span class="token comment">// 使用新增的反射API</span>
Reflect<span class="token punctuation">.</span><span class="token function">ownKeys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token comment">// [Symbol(name), 'age', 'title']</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>应用场景 2：使用 Symbol 来替代常量</strong></p> <p>先来看一下下面的代码，是不是在你的代码里经常会出现？</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">TYPE_AUDIO</span> <span class="token operator">=</span> <span class="token string">'AUDIO'</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_VIDEO</span> <span class="token operator">=</span> <span class="token string">'VIDEO'</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_IMAGE</span> <span class="token operator">=</span> <span class="token string">'IMAGE'</span>

<span class="token keyword">function</span> <span class="token function">handleFileResource</span><span class="token punctuation">(</span><span class="token parameter">resource</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>resource<span class="token punctuation">.</span>type<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token constant">TYPE_AUDIO</span><span class="token operator">:</span>
      <span class="token function">playAudio</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token constant">TYPE_VIDEO</span><span class="token operator">:</span>
      <span class="token function">playVideo</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token keyword">case</span> <span class="token constant">TYPE_IMAGE</span><span class="token operator">:</span>
      <span class="token function">previewImage</span><span class="token punctuation">(</span>resource<span class="token punctuation">)</span>
      <span class="token keyword">break</span>
    <span class="token keyword">default</span><span class="token operator">:</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">'Unknown type of resource'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>如上面的代码中那样，我们经常定义一组常量来代表一种业务逻辑下的几个不同类型，我们通常希望这几个常量之间是唯一的关系，为了保证这一点，我们需要为常量赋一个唯一的值（比如这里的'AUDIO'、'VIDEO'、 'IMAGE'），常量少的时候还算好，但是常量一多，你可能还得花点脑子好好为他们取个好点的名字。</p> <p>现在有了 Symbol，我们大可不必这么麻烦了：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">TYPE_AUDIO</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_VIDEO</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token constant">TYPE_IMAGE</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>这样定义，直接就保证了三个常量的值是唯一的了！是不是挺方便的呢。</p> <p><strong>应用场景 3：使用 Symbol 定义类的私有属性/方法</strong></p> <p>我们知道在 JavaScript 中，是没有如 Java 等面向对象语言的访问控制关键字 private 的，类上所有定义的属性或方法都是可公开访问的。因此这对我们进行 API 的设计时造成了一些困扰。</p> <p>而有了 Symbol 以及模块化机制，类的私有属性和方法才变成可能。例如：</p> <p>在文件 a.js 中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token constant">PASSWORD</span> <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">class</span> <span class="token class-name">Login</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">username<span class="token punctuation">,</span> password</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username
    <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PASSWORD</span><span class="token punctuation">]</span> <span class="token operator">=</span> password
  <span class="token punctuation">}</span>

  <span class="token function">checkPassword</span><span class="token punctuation">(</span><span class="token parameter">pwd</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">[</span><span class="token constant">PASSWORD</span><span class="token punctuation">]</span> <span class="token operator">===</span> pwd
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> Login
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>在文件 b.js 中</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">import</span> Login <span class="token keyword">from</span> <span class="token string">'./a'</span>

<span class="token keyword">const</span> login <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Login</span><span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'123456'</span><span class="token punctuation">)</span>

login<span class="token punctuation">.</span><span class="token function">checkPassword</span><span class="token punctuation">(</span><span class="token string">'123456'</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

login<span class="token punctuation">.</span><span class="token constant">PASSWORD</span> <span class="token comment">// oh!no!</span>
login<span class="token punctuation">[</span><span class="token constant">PASSWORD</span><span class="token punctuation">]</span> <span class="token comment">// oh!no!</span>
login<span class="token punctuation">[</span><span class="token string">'PASSWORD'</span><span class="token punctuation">]</span> <span class="token comment">// oh!no!</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>由于 Symbol 常量 PASSWORD 被定义在 a.js 所在的模块中，外面的模块获取不到这个 Symbol，也不可能再创建一个一模一样的 Symbol 出来（因为 Symbol 是唯一的），因此这个 PASSWORD 的 Symbol 只能被限制在 a.js 内部使用，所以使用它来定义的类属性是没有办法被模块外访问到的，达到了一个私有化的效果。</p> <p><strong>手动实现 Symbol：</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> root <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token keyword">var</span> generateName <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">var</span> postfix <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">descString</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            postfix<span class="token operator">++</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">'@@'</span> <span class="token operator">+</span> descString <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">+</span> postfix
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">var</span> <span class="token function-variable function">SymbolPolyfill</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token parameter">description</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">SymbolPolyfill</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">TypeError</span><span class="token punctuation">(</span><span class="token string">'Symbol is not a constructor'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">var</span> descString <span class="token operator">=</span> description <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span>

        <span class="token keyword">var</span> symbol <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token function-variable function">toString</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>__Name__<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token function-variable function">valueOf</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>

        Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>symbol<span class="token punctuation">,</span> <span class="token punctuation">{</span>
            <span class="token string">'__Description__'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                value<span class="token operator">:</span> descString<span class="token punctuation">,</span>
                writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                configurable<span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token string">'__Name__'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
                value<span class="token operator">:</span> <span class="token function">generateName</span><span class="token punctuation">(</span>descString<span class="token punctuation">)</span><span class="token punctuation">,</span>
                writable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
                configurable<span class="token operator">:</span> <span class="token boolean">false</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> symbol<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">var</span> forMap <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>SymbolPolyfill<span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token string">'for'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">description</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">var</span> descString <span class="token operator">=</span> description <span class="token operator">===</span> <span class="token keyword">undefined</span> <span class="token operator">?</span> <span class="token keyword">undefined</span> <span class="token operator">:</span> <span class="token function">String</span><span class="token punctuation">(</span>description<span class="token punctuation">)</span>
                <span class="token keyword">return</span> forMap<span class="token punctuation">[</span>descString<span class="token punctuation">]</span> <span class="token operator">?</span> forMap<span class="token punctuation">[</span>descString<span class="token punctuation">]</span> <span class="token operator">:</span> forMap<span class="token punctuation">[</span>descString<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">SymbolPolyfill</span><span class="token punctuation">(</span>descString<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            configurable<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token string">'keyFor'</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token function-variable function">value</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">symbol</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> forMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>forMap<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">===</span> symbol<span class="token punctuation">)</span> <span class="token keyword">return</span> key<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token punctuation">,</span>
            writable<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
            enumerable<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
            configurable<span class="token operator">:</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    root<span class="token punctuation">.</span>SymbolPolyfill <span class="token operator">=</span> SymbolPolyfill<span class="token punctuation">;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br></div></div><h2 id="四、javascript-中的变量在内存中的具体存储形式"><a href="#四、javascript-中的变量在内存中的具体存储形式" class="header-anchor">#</a> 四、JavaScript 中的变量在内存中的具体存储形式</h2> <p><strong>栈内存和堆内存</strong></p> <blockquote><p>JavaScript 中的变量分为基本类型和引用类型
基本类型是保存在栈内存中的简单数据段，它们的值都有固定的大小，保存在栈空间，通过按值访问</p></blockquote> <blockquote><p>引用类型是保存在堆内存中的对象，值大小不固定，栈内存中存放的该对象的访问地址指向堆内存中的对象，JavaScript 不允许直接访问堆内存中的位置，因此操作对象时，实际操作对象的引用</p></blockquote> <p><strong>结合代码与图来理解</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> a1 <span class="token operator">=</span> <span class="token number">0</span> <span class="token comment">// 栈内存</span>
<span class="token keyword">let</span> a2 <span class="token operator">=</span> <span class="token string">'this is string'</span> <span class="token comment">// 栈内存</span>
<span class="token keyword">let</span> a3 <span class="token operator">=</span> <span class="token keyword">null</span> <span class="token comment">// 栈内存</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span> <span class="token comment">// 变量b存在于栈中，{ x: 10 }作为对象存在于堆中</span>
<span class="token keyword">let</span> c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// 变量c存在于栈中，[1, 2, 3]作为对象存在于堆中</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="https://upload-images.jianshu.io/upload_images/12665637-b7878064411df56a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800/format/webp" alt=""></p> <p>当我们要访问堆内存中的引用数据类型时</p> <ol><li>从栈中获取该对象的地址引用</li> <li>再从堆内存中取得我们需要的数据</li></ol> <p><strong>基本类型发生复制行为</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token number">20</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> a
b <span class="token operator">=</span> <span class="token number">30</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span> <span class="token comment">// 20</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>结合下面图进行理解：</p> <p><img src="https://upload-images.jianshu.io/upload_images/12665637-2c146471c6ced07b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800/format/webp" alt=""></p> <p><strong>在栈内存中的数据发生复制行为时，系统会自动为新的变量分配一个新值，最后这些变量都是相互独立互不影响的</strong></p> <p><strong>引用类型发生复制行为</strong></p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> a <span class="token operator">=</span> <span class="token punctuation">{</span> x<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> y<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
<span class="token keyword">let</span> b <span class="token operator">=</span> a
b<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token number">5</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>a<span class="token punctuation">.</span>x<span class="token punctuation">)</span> <span class="token comment">// 5</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ol><li>引用类型的复制，同样为新的变量 b 分配一个新的值，保存在栈内存中，不同的是，这个值仅仅是引用类型的一个地址指针</li> <li>他们两个指向同一个值，也就是地址指针相同，在堆内存中访问到的具体对象实际上是同一个</li> <li>因此改变 b.x 时，a.x 也发生了变化，这就是引用类型的特性</li></ol> <p><strong>结合下图理解</strong></p> <p><img src="https://upload-images.jianshu.io/upload_images/12665637-efd7b9913c0e23a2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/800/format/webp" alt=""></p> <p><strong>总结</strong></p> <p><img src="https://upload-images.jianshu.io/upload_images/12665637-aa862638a1e26ae5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/648/format/webp" alt=""></p> <h2 id="五、基本类型对应的内置对象，以及他们之间的装箱拆箱操作"><a href="#五、基本类型对应的内置对象，以及他们之间的装箱拆箱操作" class="header-anchor">#</a> 五、基本类型对应的内置对象，以及他们之间的装箱拆箱操作</h2> <p><strong>JS 中的内置函数（对象）</strong></p> <p>String()、Number()、Boolean()、RegExp()、Date()、Error()、Array()、Function()、Object()、symbol();类似于对象的构造函数</p> <p>1、这些内置函数构造的变量都是封装了基本类型值的对象如：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'abb'</span><span class="token punctuation">)</span> <span class="token comment">// typeof(a)=object</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>除了利用 Function()构造的变量通过 typeof 输出为 function 外其他均为 object</p> <p>2、为了知道构造的变量的真实类型可以利用：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// &quot;[object,array]&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>后面的一个值即为传入参数的类型</p> <p>3、如果有常量形式（即利用基本数据类型）赋值给变量就不要用该方式来定义变量</p> <p><strong>装箱</strong></p> <p>就是把基本类型转变为对应的对象。装箱分为隐式和显示</p> <ul><li>隐式装箱： 每当读取一个基本类型的值时，后台会创建一个该基本类型所对应的对象。在这个基本类型上调用方法，其实是在这个基本类型对象上调用方法。这个基本类型的对象是临时的，它只存在于方法调用那一行代码执行的瞬间，执行方法后立刻被销毁。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> num <span class="token operator">=</span> <span class="token number">123</span>
num<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// '123.00'//上方代码在后台的真正步骤为</span>
<span class="token keyword">var</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Number</span><span class="token punctuation">(</span><span class="token number">123</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
c <span class="token operator">=</span> <span class="token keyword">null</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>(1)创建一个 Number 类型的实例。</p> <p>(2)在实例上调用方法。</p> <p>(3)销毁实例。</p> <ul><li>显式装箱: 通过内置对象 Boolean、Object、String 等可以对基本类型进行显示装箱。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span><span class="token string">'123'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>拆箱</strong></p> <p>拆箱与装箱相反，把对象转变为基本类型的值。拆箱过程内部调用了抽象操作 ToPrimitive 。该操作接受两个参数，第一个参数是要转变的对象，第二个参数 PreferredType 是对象被期待转成的类型。第二个参数不是必须的，默认该参数为 number，即对象被期待转为数字类型</p> <ul><li><p>Number 转化为对象</p> <p>1.先调用对象自身的 valueOf 方法。如果返回原始类型的值，则直接对该值使用 Number 函数，返回结果。</p> <p>2.如果 valueOf 返回的还是对象，继续调用对象自身的 toString 方法。如果 toString 返回原始类型的值，则对该值使用 Number 函数，返回结果。</p> <p>3.如果 toString 返回的还是对象，报错。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">Number</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//1</span>
转换演变：
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// [1];</span>
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '1';Number('1'); //1</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p>String 转化为对象</p> <p>1.先调用对象自身的 toString 方法。如果返回原始类型的值，则对该值使用 String 函数，返回结果。</p> <p>2.如果 toString 返回的是对象，继续调用 valueOf 方法。如果 valueOf 返回原始类型的值，则对该值使用 String 函数，返回结果。</p> <p>3.如果 valueOf 返回的还是对象，报错。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function">String</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">//&quot;1,2&quot;</span>
转化演变：
<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;1,2&quot;</span>
<span class="token function">String</span><span class="token punctuation">(</span><span class="token string">&quot;1,2&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//&quot;1,2&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li><p>Boolean 转化对象</p> <p>Boolean 转换对象很特别，除了以下六个值转换为 false，其他都为 true</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">undefined</span>  <span class="token keyword">null</span>  <span class="token boolean">false</span>  <span class="token number">0</span><span class="token punctuation">(</span>包括<span class="token operator">+</span><span class="token number">0</span>和<span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span>  <span class="token number">NaN</span>  <span class="token function">空字符串</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token comment">//false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>        <span class="token comment">//false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span>       <span class="token comment">//false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>           <span class="token comment">//false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span>         <span class="token comment">//false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>          <span class="token comment">//false</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>          <span class="token comment">//true</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>          <span class="token comment">//true</span>
<span class="token function">Boolean</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment">//true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="六、理解值类型和引用类型"><a href="#六、理解值类型和引用类型" class="header-anchor">#</a> 六、理解值类型和引用类型</h2> <p><strong>a 声明变量时不同的内存分配：</strong></p> <p>1）原始值：存储在栈（stack）中的简单数据段，也就是说，它们的值直接存储在变量访问的位置。</p> <p>这是因为这些原始类型占据的空间是固定的，所以可将他们存储在较小的内存区域 – 栈中。这样存储便于迅速查寻变量的值。</p> <p>2）引用值：存储在堆（heap）中的对象，也就是说，存储在变量处的值是一个指针（point），指向存储对象的内存地址。</p> <p>这是因为：引用值的大小会改变，所以不能把它放在栈中，否则会降低变量查寻的速度。相反，放在变量的栈空间中的值是该对象存储在堆中的地址。
地址的大小是固定的，所以把它存储在栈中对变量性能无任何负面影响。</p> <p><strong>b 不同的内存分配机制也带来了不同的访问机制</strong></p> <p>1）在 JS 中是不允许直接访问保存在堆内存中的对象的，所以在访问一个对象时，首先得到的是这个对象在堆内存中的地址，然后再按照这个地址去获得这个对象中的值，这就是传说中的按引用访问。</p> <p>2）而原始类型的值则是可以直接访问到的。</p> <p><strong>c 复制变量时的不同</strong></p> <p>1）原始值：在将一个保存着原始值的变量复制给另一个变量时，会将原始值的副本赋值给新变量，此后这两个变量是完全独立的，他们只是拥有相同的值而已，彼此都是独立的。</p> <p>2）引用值：在将一个保存着对象内存地址的变量复制给另一个变量时，会把这个内存地址赋值给新变量，也就是说这两个变量都指向了堆内存中的同一个对象，他们中任何一个作出的改变都会反映在另一个身上。（复制对象时并不会在堆内存中新生成一个一模一样的对象，只是多了一个保存指向这个对象指针的变量罢了）</p> <p><strong>d 参数传递的不同（把实参复制给形参的过程）</strong></p> <p>首先我们应该明确一点：ECMAScript 中所有函数的参数都是按值来传递的。
但是为什么涉及到原始类型与引用类型的值时仍然有区别呢？还不就是因为内存分配时的差别。</p> <p>1）原始值：只是把变量里的值传递给参数，之后参数和这个变量互不影响。</p> <p>2）引用值：对象变量它里面的值是这个对象在堆内存中的内存地址，这一点你要时刻铭记在心！</p> <p>因此它传递的值也就是这个内存地址，这也就是为什么函数内部对这个参数的修改会体现在外部的原因了，因为它们都指向同一个对象。</p> <h2 id="七、null-和-undefined-的区别"><a href="#七、null-和-undefined-的区别" class="header-anchor">#</a> 七、null 和 undefined 的区别</h2> <p><strong>定义</strong></p> <p>Null 类型：Null 类型也只有一个特殊的值——null。从逻辑角度来看，null 值表示一个空对象指针。</p> <p>Undefined 类型：Undefined 类型只有一个值，即特殊的 undefined。在使用 var 声明变量但未对其加以初始化时，这个变量的值就是 undefined。</p> <p><strong>null 和 undefined 的应用场景</strong></p> <p>null 表示&quot;没有对象&quot;，即该处不应该有值。典型用法是：</p> <p>（1） 作为函数的参数，表示该函数的参数不是对象。</p> <p>（2） 作为对象原型链的终点。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>undefined 表示&quot;缺少值&quot;，就是此处应该有一个值，但是还没有定义。典型用法是：</p> <p>（1）变量被声明了，但没有赋值时，就等于 undefined。</p> <p>（2) 调用函数时，应该提供的参数没有提供，该参数等于 undefined。</p> <p>（3）对象没有赋值的属性，该属性的值为 undefined。</p> <p>（4）函数没有返回值时，默认返回 undefined。</p> <p><strong>Number 转换的值</strong></p> <p>Number(null)输出为 0, Number(undefined)输出为 NaN</p> <h2 id="八、至少可以说出三种判断-javascript-数据类型的方式，以及他们的优缺点，如何准确的判断数组类型"><a href="#八、至少可以说出三种判断-javascript-数据类型的方式，以及他们的优缺点，如何准确的判断数组类型" class="header-anchor">#</a> 八、至少可以说出三种判断 JavaScript 数据类型的方式，以及他们的优缺点，如何准确的判断数组类型</h2> <p><strong>typeof</strong></p> <ul><li>适用场景</li></ul> <p><code>typeof</code>操作符可以准确判断一个变量是否为下面几个原始类型：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token string">'ConardLi'</span> <span class="token comment">// string</span>
<span class="token keyword">typeof</span> <span class="token number">123</span> <span class="token comment">// number</span>
<span class="token keyword">typeof</span> <span class="token boolean">true</span> <span class="token comment">// boolean</span>
<span class="token keyword">typeof</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// symbol</span>
<span class="token keyword">typeof</span> <span class="token keyword">undefined</span> <span class="token comment">// undefined</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>你还可以用它来判断函数类型：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// function</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>不适用场景</p> <p>当你用<code>typeof</code>来判断引用类型时似乎显得有些乏力了：</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">typeof</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// object</span>
<span class="token keyword">typeof</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// object</span>
<span class="token keyword">typeof</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// object</span>
<span class="token keyword">typeof</span> <span class="token operator">/</span><span class="token operator">^</span>\d<span class="token operator">*</span>$<span class="token operator">/</span> <span class="token comment">// object</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>除函数外所有的引用类型都会被判定为<code>object</code>。</p> <p>另外<code>typeof null === 'object'</code>也会让人感到头痛，这是在<code>JavaScript</code>初版就流传下来的<code>bug</code>，后面由于修改会造成大量的兼容问题就一直没有被修复...</p> <p><strong>instanceof</strong></p> <p><code>instanceof</code>操作符可以帮助我们判断引用类型具体是什么类型的对象：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Array</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">Date</span> <span class="token comment">// true</span>
<span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">instanceof</span> <span class="token class-name">RegExp</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>我们先来回顾下原型链的几条规则：</p> <ul><li>1.所有引用类型都具有对象特性，即可以自由扩展属性</li> <li>2.所有引用类型都具有一个<code>__proto__</code>（隐式原型）属性，是一个普通对象</li> <li>3.所有的函数都具有<code>prototype</code>（显式原型）属性，也是一个普通对象</li> <li>4.所有引用类型<code>__proto__</code>值指向它构造函数的<code>prototype</code></li> <li>5.当试图得到一个对象的属性时，如果变量本身没有这个属性，则会去他的<code>__proto__</code>中去找</li></ul> <p><code>[] instanceof Array</code>实际上是判断<code>Array.prototype</code>是否在<code>[]</code>的原型链上。
所以，使用<code>instanceof</code>来检测数据类型，不会很准确，这不是它设计的初衷：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token comment">// true</span>
<span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>  <span class="token keyword">instanceof</span> <span class="token class-name">Object</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>另外，使用<code>instanceof</code>也不能检测基本数据类型，所以<code>instanceof</code>并不是一个很好的选择。</p> <p><strong>toString</strong></p> <p>上面我们在拆箱操作中提到了<code>toString</code>函数，我们可以调用它实现从引用类型的转换。</p> <blockquote><p>每一个引用类型都有<code>toString</code>方法，默认情况下，<code>toString()</code>方法被每个<code>Object</code>对象继承。如果此方法在自定义对象中未被覆盖，<code>toString()</code>  返回  <code>&quot;[object type]&quot;</code>，其中<code>type</code>是对象的类型。</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
obj<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// [object Object]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>注意，上面提到了<code>如果此方法在自定义对象中未被覆盖</code>，<code>toString</code>才会达到预想的效果，事实上，大部分引用类型比如<code>Array、Date、RegExp</code>等都重写了<code>toString</code>方法。</p> <p>我们可以直接调用<code>Object</code>原型上未被覆盖的<code>toString()</code>方法，使用<code>call</code>来改变<code>this</code>指向来达到我们想要的效果。
<img src="https://upload-images.jianshu.io/upload_images/12812588-c1759f7c82d6f7cd.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p> <p><strong>jquery</strong></p> <p>我们来看看<code>jquery</code>源码中如何进行类型判断：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> class2type <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
jQuery<span class="token punctuation">.</span><span class="token function">each</span><span class="token punctuation">(</span> <span class="token string">&quot;Boolean Number String Function Array Date RegExp Object Error Symbol&quot;</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span> <span class="token string">&quot; &quot;</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">i<span class="token punctuation">,</span> name</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	class2type<span class="token punctuation">[</span> <span class="token string">&quot;[object &quot;</span> <span class="token operator">+</span> name <span class="token operator">+</span> <span class="token string">&quot;]&quot;</span> <span class="token punctuation">]</span> <span class="token operator">=</span> name<span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function-variable function">type</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">obj</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token punctuation">(</span> obj <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> obj <span class="token operator">+</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">||</span> <span class="token keyword">typeof</span> obj <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span> <span class="token operator">?</span>
		class2type<span class="token punctuation">[</span><span class="token class-name">Object</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token string">&quot;object&quot;</span> <span class="token operator">:</span>
		<span class="token keyword">typeof</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token function-variable function">isFunction</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> <span class="token parameter">obj</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> jQuery<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">&quot;function&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>原始类型直接使用<code>typeof</code>，引用类型使用<code>Object.prototype.toString.call</code>取得类型。
判断数组类型可以用 <code>Array.isArray(value)</code> 或者 <code>Object.prototype.toString.call(value)</code> 。</p> <h2 id="九、可能发生隐式类型转换的场景以及转换原则，应如何避免或巧妙应用"><a href="#九、可能发生隐式类型转换的场景以及转换原则，应如何避免或巧妙应用" class="header-anchor">#</a> 九、可能发生隐式类型转换的场景以及转换原则，应如何避免或巧妙应用</h2> <p>因为<code>JavaScript</code>是弱类型的语言，所以类型转换发生非常频繁，上面我们说的装箱和拆箱其实就是一种类型转换。</p> <p>类型转换分为两种，隐式转换即程序自动进行的类型转换，强制转换即我们手动进行的类型转换。</p> <p>强制转换这里就不再多提及了，下面我们来看看让人头疼的可能发生隐式类型转换的几个场景，以及如何转换：</p> <p><strong>类型转换规则</strong></p> <p>如果发生了隐式转换，那么各种类型互转符合下面的规则：
<img src="https://upload-images.jianshu.io/upload_images/12812588-11f49232fdfa5ebc.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt=""></p> <p><strong>if 语句和逻辑语句</strong></p> <p>在<code>if</code>语句和逻辑语句中，如果只有单个变量，会先将变量转换为<code>Boolean</code>值，只有下面几种情况会转换成<code>false</code>，其余被转换成<code>true</code>：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">null</span>
<span class="token keyword">undefined</span>
<span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
<span class="token number">NaN</span>
<span class="token number">0</span>
<span class="token boolean">false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>各种运数学算符</strong></p> <p>我们在对各种非<code>Number</code>类型运用数学运算符(<code>- * /</code>)时，会先将非<code>Number</code>类型转换为<code>Number</code>类型;</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">1</span> <span class="token operator">-</span> <span class="token boolean">true</span> <span class="token comment">// 0</span>
<span class="token number">1</span> <span class="token operator">-</span> <span class="token keyword">null</span> <span class="token comment">//  1</span>
<span class="token number">1</span> <span class="token operator">*</span> <span class="token keyword">undefined</span> <span class="token comment">//  NaN</span>
<span class="token number">2</span> <span class="token operator">*</span> <span class="token punctuation">[</span><span class="token string">'5'</span><span class="token punctuation">]</span> <span class="token comment">//  10</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>注意<code>+</code>是个例外，执行<code>+</code>操作符时：</p> <ul><li>1.当一侧为<code>String</code>类型，被识别为字符串拼接，并会优先将另一侧转换为字符串类型。</li> <li>2.当一侧为<code>Number</code>类型，另一侧为原始类型，则将原始类型转换为<code>Number</code>类型。</li> <li>3.当一侧为<code>Number</code>类型，另一侧为引用类型，将引用类型和<code>Number</code>类型转换成字符串后拼接。</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">123</span> <span class="token operator">+</span> <span class="token string">'123'</span> <span class="token comment">// 123123   （规则1）</span>
<span class="token number">123</span> <span class="token operator">+</span> <span class="token keyword">null</span> <span class="token comment">// 123    （规则2）</span>
<span class="token number">123</span> <span class="token operator">+</span> <span class="token boolean">true</span> <span class="token comment">// 124    （规则2）</span>
<span class="token number">123</span> <span class="token operator">+</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// 123[object Object]    （规则3）</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>==</strong></p> <p>使用<code>==</code>时，若两侧类型相同，则比较结果和<code>===</code>相同，否则会发生隐式转换，使用<code>==</code>时发生的转换可以分为几种不同的情况（只考虑两侧类型不同）：</p> <ul><li><p>1.NaN</p> <p><code>NaN</code>和其他任何类型比较永远返回<code>false</code>(包括和他自己)。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">NaN</span> <span class="token operator">==</span> <span class="token number">NaN</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p>2.Boolean</p> <p><code>Boolean</code>和其他任何类型比较，<code>Boolean</code>首先被转换为<code>Number</code>类型。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token boolean">true</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token comment">// true</span>
<span class="token boolean">true</span> <span class="token operator">==</span> <span class="token string">'2'</span> <span class="token comment">// false</span>
<span class="token boolean">true</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token string">'1'</span><span class="token punctuation">]</span> <span class="token comment">// true</span>
<span class="token boolean">true</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token string">'2'</span><span class="token punctuation">]</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><blockquote><p>这里注意一个可能会弄混的点：<code>undefined、null</code>和<code>Boolean</code>比较，虽然<code>undefined、null</code>和<code>false</code>都很容易被想象成假值，但是他们比较结果是<code>false</code>，原因是<code>false</code>首先被转换成<code>0</code>：</p></blockquote> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">undefined</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment">// false</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>3.String 和 Number</p> <p><code>String</code>和<code>Number</code>比较，先将<code>String</code>转换为<code>Number</code>类型。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token number">123</span> <span class="token operator">==</span> <span class="token string">'123'</span> <span class="token comment">// true</span>
<span class="token string">''</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li><p>4.null 和 undefined</p> <p><code>null == undefined</code>比较结果是<code>true</code>，除此之外，<code>null、undefined</code>和其他任何结果的比较值都为<code>false</code>。</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">null</span> <span class="token operator">==</span> <span class="token keyword">undefined</span> <span class="token comment">// true</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token comment">// false</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token comment">// false</span>
<span class="token keyword">null</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment">// false</span>
<span class="token keyword">undefined</span> <span class="token operator">==</span> <span class="token string">''</span> <span class="token comment">// false</span>
<span class="token keyword">undefined</span> <span class="token operator">==</span> <span class="token number">0</span> <span class="token comment">// false</span>
<span class="token keyword">undefined</span> <span class="token operator">==</span> <span class="token boolean">false</span> <span class="token comment">// false</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li><p>5.原始类型和引用类型</p> <p>当原始类型和引用类型做比较时，对象类型会依照<code>ToPrimitive</code>规则转换为原始类型:</p></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token string">'[object Object]'</span> <span class="token operator">==</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment">// true</span>
<span class="token string">'1,2,3'</span> <span class="token operator">==</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>来看看下面这个比较：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token operator">!</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><code>!</code>的优先级高于<code>==</code>，<code>![]</code>首先会被转换为<code>false</code>，然后根据上面第三点，<code>false</code>转换成<code>Number</code>类型<code>0</code>，左侧<code>[]</code>转换为<code>0</code>，两侧比较相等。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">null</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token boolean">false</span><span class="token punctuation">[</span><span class="token keyword">undefined</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token comment">// true</span>
  <span class="token boolean">false</span> <span class="token comment">// true</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>根据数组的<code>ToPrimitive</code>规则，数组元素为<code>null</code>或<code>undefined</code>时，该元素被当做空字符串处理，所以<code>[null]、[undefined]</code>都会被转换为<code>0</code>。
所以，说了这么多，推荐使用<code>===</code>来判断两个值是否相等...</p> <p><strong>一道有意思的面试题</strong></p> <p>一道经典的面试题，如何让：<code>a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3</code>。
根据上面的拆箱转换，以及<code>==</code>的隐式转换，我们可以轻松写出答案：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token punctuation">{</span>
  value<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token function-variable function">valueOf</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>value<span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="十、出现小数精度丢失的原因，javascript-可以存储的最大数字、最大安全数字，javascript-处理大数字的方法、避免精度丢失的方法"><a href="#十、出现小数精度丢失的原因，javascript-可以存储的最大数字、最大安全数字，javascript-处理大数字的方法、避免精度丢失的方法" class="header-anchor">#</a> 十、出现小数精度丢失的原因，JavaScript 可以存储的最大数字、最大安全数字，JavaScript 处理大数字的方法、避免精度丢失的方法</h2> <p><strong>出现小数精度丢失的原因</strong></p> <p>计算机的二进制实现和位数限制有些数无法有限表示。就像一些无理数不能有限表示，如 圆周率 3.1415926...，1.3333... 等。JS 遵循  <a href="https://link.jianshu.com/?t=https://en.wikipedia.org/wiki/IEEE_floating_point" target="_blank" rel="noopener noreferrer">IEEE 754<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>  规范，采用双精度存储（double precision），占用 64 bit。如图
<img src="https://upload-images.jianshu.io/upload_images/7871032-7f3a2bc6b91af78d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp" alt=""></p> <p>意义</p> <p>1 位用来表示符号位</p> <p>11 位用来表示指数</p> <p>52 位表示尾数</p> <p>浮点数，比如</p> <p>1</p> <p>2</p> <p>0.1 &gt;&gt; 0.0001 1001 1001 1001…（1001 无限循环）</p> <p>0.2 &gt;&gt; 0.0011 0011 0011 0011…（0011 无限循环）</p> <p>此时只能模仿十进制进行四舍五入了，但是二进制只有 0 和 1 两个，于是变为 0 舍 1 入。这即是计算机中部分浮点数运算时出现误差，丢失精度的根本原因。
JS 的最大和最小安全值可以这样获得:</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Number<span class="token punctuation">.</span><span class="token constant">MAX_SAFE_INTEGER</span><span class="token punctuation">)</span> <span class="token comment">//9007199254740991</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Number<span class="token punctuation">.</span><span class="token constant">MIN_SAFE_INTEGER</span><span class="token punctuation">)</span> <span class="token comment">//-9007199254740991</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>对于整数，前端出现问题的几率可能比较低，毕竟很少有业务需要需要用到超大整数，只要运算结果不超过 Math.pow(2, 53) 就不会丢失精度。如果实在是超过最大安全数字了，那就用 BigInt(Number)计算。</p> <p>对于小数，前端出现问题的几率还是很多的，尤其在一些电商网站涉及到金额等数据。解决方式：把小数放到位整数（乘倍数），再缩小回原来倍数（除倍数），也就是说，尽量在业务中避免处理小数</p></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-1e128e82 data-v-1e128e82><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-1e128e82><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-1e128e82></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-1e128e82></path></svg></div></div></div>
    <script src="/zhangqcoder.github.io/assets/js/app.2fbe9a60.js" defer></script><script src="/zhangqcoder.github.io/assets/js/3.9b3e945d.js" defer></script><script src="/zhangqcoder.github.io/assets/js/1.536d7332.js" defer></script><script src="/zhangqcoder.github.io/assets/js/14.03153890.js" defer></script>
  </body>
</html>
